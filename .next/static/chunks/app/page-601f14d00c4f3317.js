(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7341:function(e,s,n){Promise.resolve().then(n.bind(n,3488))},2938:function(){},1723:function(){},3488:function(e,s,n){"use strict";let o;n.r(s),n.d(s,{default:function(){return S}});var c=n(7437);n(703);var r=n(828),t=n(2265),a=n(8209),l=n(4725),i=n(6123);n(8062);var d=()=>{let e=(0,r.I0)();return(0,t.useEffect)(()=>((o=(0,a.ZP)("ws://monitoring.qpart.com.ua:5000",{extraHeaders:{type:"webclient"}})).on("connect",()=>{console.log("Connected to WebSocket server"),i.Am.success("Connected",{autoClose:1e3,hideProgressBar:!0})}),o.on("message",e=>{}),o.on("webclient",s=>{console.log("webclient",s);let n=JSON.parse(s);console.log(n),console.log("Received message:",n.payload);let o=n.payload;"info"===n.topic&&e((0,l.e)(o)),"result"===n.topic&&(console.log("result toast"),i.Am.success("Результат: ".concat(n.payload.result||"undefined"),{autoClose:1e3,hideProgressBar:!0}))}),o.on("error",e=>{console.error("WebSocket connection error:",e),console.error("WebSocket connection error:",e.code),i.Am.error("Conection error",{autoClose:1e4,hideProgressBar:!0})}),o.on("connect_error",e=>{console.error("Connect_error:",e.type,e),console.error("Connect_error:",e.type,e.code),console.error("Connect_error:",e.type,e.message),i.Am.error("Conection error",{autoClose:1e4,hideProgressBar:!0})}),()=>{o.disconnect(),i.Am.warning("Disconnect",{autoClose:3e3,hideProgressBar:!0})}),[]),(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(i.Ix,{})})};let m=e=>{let{inputText:s,deviceId:n}=e;console.log(s),console.log(n);let c={topic:"command",payload:{id:n,command:s}};console.log(c),o&&o.connected?(o.emit("message",JSON.stringify(c)),console.log("повідомлення відправлено")):console.error("Socket is not connected")};n(1068);var u=n(2098);n(1723);var x=e=>{let{usedSpace:s,totalSpace:n,availableSpace:o}=e,r=0===n?1:Math.round(n),t="".concat(o," ГБ вільно з ").concat(r," ГБ");return(0,c.jsxs)("div",{className:"progress-container",children:[(0,c.jsx)(u.Z,{now:Math.round(s),max:r,className:"bg-secondary ",style:{color:"grey",height:"15px"}}),(0,c.jsx)("span",{className:"progress-label ",children:t})]})};n(197);var h=e=>{let{online:s,timeLastInfo:n,uptime:o}=e;return(0,c.jsx)("div",{children:s?(0,c.jsxs)("span",{style:{color:"black"},children:["Онлайн. Працює вже ",o]}):(0,c.jsxs)("span",{style:{color:"grey"},children:["Офлайн. Останній раз в мережі ",(e=>{let s=new Date(e),n=("0"+s.getDate()).slice(-2),o=("0"+(s.getMonth()+1)).slice(-2),c=("0"+s.getHours()).slice(-2),r=("0"+s.getMinutes()).slice(-2);return"".concat(n,".").concat(o," ").concat(c,":").concat(r)})(n)]})})};n(2938);var p=n(6550),j=n(7057),v=e=>{let{deviceId:s,show:n,onHide:o,device:r}=e;console.log("deviceId",s);let t=(e,s)=>{console.log("sendDataToServer from deviceMenu"),console.log(e),console.log(s),m({inputText:e,deviceId:s})},a=e=>{let{name:n,command:o}=e;return(0,c.jsxs)("div",{className:"menu-button",onClick:()=>t(o,s),children:[(0,c.jsx)(p.Z,{variant:"outline-primary",className:"w-100",children:n})," "]})};return(0,c.jsxs)(j.Z,{show:n,onHide:o,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[(0,c.jsx)(j.Z.Header,{closeButton:!0,children:(0,c.jsxs)(j.Z.Title,{id:"contained-modal-title-vcenter",children:["Компьютер ",r.name]})}),(0,c.jsxs)(j.Z.Body,{children:[(0,c.jsx)(a,{name:"вимкнути",command:"shutdown /s /t 0"}),(0,c.jsx)(a,{name:"перезавантажити",command:"shutdown /r /t 0"})]})]})},g=n(9151),N=function(e){let{show:s,onHide:n,onConfirm:o}=e;return(0,c.jsxs)(j.Z,{show:s,onHide:n,children:[(0,c.jsx)(j.Z.Header,{closeButton:!0,children:(0,c.jsx)(j.Z.Title,{children:"Підтвердження операції"})}),(0,c.jsx)(j.Z.Body,{children:"Ви впевнені, що хочете виконати цю операцію?"}),(0,c.jsxs)(j.Z.Footer,{children:[(0,c.jsx)(p.Z,{variant:"secondary",onClick:n,children:"Скасувати"}),(0,c.jsx)(p.Z,{variant:"primary",onClick:o,children:"Підтвердити"})]})]})},y=e=>{let{diskName:s,deviceId:n,show:o,onHide:a,device:l}=e,[i,d]=(0,t.useState)(!1),u=(0,r.v9)(e=>e.devices).find(e=>e.id===n).disk.find(e=>e.mounted===s),x=(e,s,n)=>({enable:'Enable-BitLocker -MountPoint "'.concat(s,'" -PasswordProtector -Password (ConvertTo-SecureString -String "').concat(e,'" -AsPlainText -Force) -UsedSpaceOnly -SkipHardwareTest'),disable:'Disable-BitLocker -MountPoint "'.concat(s,'"'),unlock:'Unlock-BitLocker -MountPoint "'.concat(s,'" -Password (ConvertTo-SecureString -String "').concat(e,'" -AsPlainText -Force)')})[n],h=e=>{let{name:s,deviceId:n,diskName:o,commandKey:r,input:a}=e,[l,i]=(0,t.useState)(""),d=x(l,o,r);return(0,c.jsx)("div",{className:"",children:(0,c.jsxs)(g.Z.Group,{className:"mb-2",children:[a?(0,c.jsx)(g.Z.Control,{variant:"outline-primary",type:"password",value:l,onChange:e=>i(e.target.value),placeholder:"введіть пароль (не менше 8 символів)",autoComplete:"off",className:"mb-2"}):"",(0,c.jsx)(p.Z,{variant:"outline-primary",className:"w-100 mb-2",onClick:()=>{m({inputText:d,deviceId:n})},children:s})]})})};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(j.Z,{show:o,onHide:a,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[(0,c.jsx)(j.Z.Header,{closeButton:!0,children:(0,c.jsxs)(j.Z.Title,{id:"contained-modal-title-vcenter",children:["Диск ",s," Компьютер ",l.name]})}),(0,c.jsx)(j.Z.Body,{children:u.locked?(0,c.jsx)(h,{name:"розблокувати диск",deviceId:n,diskName:s,commandKey:"unlock",input:!0}):u.crypt?(0,c.jsx)(h,{name:"вимкнути шифрування",deviceId:n,diskName:s,commandKey:"disable",input:!1}):(0,c.jsx)(h,{name:"активувати шифрування",deviceId:n,diskName:s,commandKey:"enable",input:!0})})]}),(0,c.jsx)(N,{show:i,onHide:()=>d(!1),onConfirm:(e,s)=>{console.log("sendDataToServer from deviceMenu"),m({inputText:e,deviceId:s})}})]})},b=n(6128),k=e=>{let{deviceId:s,diskName:n,device:o,diskCrypt:r}=e,[a,l]=(0,t.useState)(!1),[i,d]=t.useState(!1);return(0,c.jsxs)("div",{className:"disk-menu-item",children:[(0,c.jsx)("div",{onClick:()=>{l(!a),d(!0)},children:(0,c.jsx)(b.zPD,{className:"display-6"})}),(0,c.jsx)(y,{device:o,deviceId:s,diskName:n,show:i,onHide:()=>d(!1)})]})},f=n(7252),w=n(1399),C=e=>{let{deviceName:s,ip:n,discs:o,deviceId:r,device:a}=e,[l,i]=t.useState(!1);return(0,c.jsxs)("div",{className:"position-relative container mb-4 border rounded p-3 pb-2 bg-dark-subtle align-items-center shadow",style:{border:"2px solid red"},children:[(0,c.jsx)(v,{deviceId:a.id,device:a,show:l,onHide:()=>i(!1)}),(0,c.jsxs)("div",{className:"row align-items-center",children:[(0,c.jsx)("div",{className:"col-10",children:(0,c.jsxs)("h3",{className:"h4 mb-2 align-item-center ",children:[a.online?(0,c.jsx)(f.Zh5,{style:{color:"green",margin:"0 0 3px 0"}}):(0,c.jsx)(f.Zh5,{style:{color:"grey",margin:"0 0 3px 0"}}),"  ",a.online?(0,c.jsx)(c.Fragment,{children:s}):(0,c.jsx)("span",{style:{color:"grey"},children:s})]})}),(0,c.jsx)("div",{className:"col-2 text-end",children:(0,c.jsx)(b.qTj,{className:"display-4",onClick:()=>{i(!0),console.log(l)}})})]}),(0,c.jsx)("div",{className:"row align-items-center p-2",children:(0,c.jsx)("div",{className:"col-12",children:(0,c.jsx)("span",{className:"mb-2 h-6 text-start",children:(0,c.jsx)(h,{online:a.online,timeLastInfo:a.timeLastInfo,uptime:a.uptime})})})}),(0,c.jsx)("p",{className:"mb-1",children:n}),(0,c.jsxs)("div",{className:"list-group",children:[o.map((e,s)=>(0,c.jsxs)("div",{className:"list-group-item mb-2 rounded",style:{background:"#dde2e7"},children:[(0,c.jsxs)("div",{className:"row mb-2 align-items-center p-2",children:[(0,c.jsx)("div",{className:"col-3 p-0 ",children:(0,c.jsxs)("span",{className:"h4",children:["Диск ",e.mounted]})}),(0,c.jsx)("div",{className:"col-7 text-start p-0",children:(0,c.jsx)("span",{className:"",children:(0,c.jsxs)("span",{className:e.crypt?"text-dark":"text-success",children:[e.crypt?"зашифровано ":"не зашифровано ",(0,c.jsx)("span",{className:"m-1"}),(e.crypt,""),e.crypt?(0,c.jsxs)(c.Fragment,{children:[" ",e.locked?(0,c.jsx)(w.kUi,{className:"text-danger"}):(0,c.jsx)(w.D5B,{className:"text-success"})," "]}):" "]})})}),(0,c.jsx)("div",{className:"col-2 text-end p-0",children:(0,c.jsx)(k,{deviceId:r,diskName:e.mounted,device:a,diskCrypt:e.crypt},s)})]}),(0,c.jsx)("div",{className:"row",children:(0,c.jsx)("span",{className:"mb-2 p-2",children:(0,c.jsx)(x,{usedSpace:e.used,availableSpace:e.available,totalSpace:e.total})})})]},s)),(0,c.jsx)("div",{className:"containter rounded"})]})]})};function S(){let e=(0,r.v9)(e=>e.devices),[s,n]=(0,t.useState)("");return console.log(e),(0,c.jsxs)("main",{className:"container mx-auto py-4",style:{maxWidth:"540px",minWidth:"320px"},children:[(0,c.jsx)(d,{}),(0,c.jsx)("div",{className:"mb-4",children:(0,c.jsx)("h1",{className:"h1",children:"Monitoring"})}),(0,c.jsx)("div",{className:"list-group",children:e.map(e=>(0,c.jsx)(C,{deviceName:e.name,ip:e.ip,discs:e.disk,deviceId:e.id,device:e},e.id))})]})}},4725:function(e,s,n){"use strict";n.d(s,{e:function(){return c}});let o=(0,n(5972).oM)({name:"devices",initialState:[],reducers:{addOrUpdateDevice(e,s){let n=s.payload,o=e.findIndex(e=>e.id===n.id);return -1!==o?(console.log("update device"),console.log(n.id),e.map((e,s)=>s===o?n:e)):(console.log("add device"),[...e,n])}}}),{addOrUpdateDevice:c}=o.actions;s.Z=o.reducer}},function(e){e.O(0,[305,699,259,674,271,181,366,971,69,744],function(){return e(e.s=7341)}),_N_E=e.O()}]);